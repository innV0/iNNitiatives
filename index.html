<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>iNNitiatives (CDN)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
</head>
<body class="bg-slate-100">
    <div id="app">
        <!-- Vue app will mount here -->
    </div>

    <script>
      const { createApp, ref, computed, watch, onMounted } = Vue;

      const App = {
        setup() {
          const message = ref('Loading App Data...');
          const appTitle = ref('iNNitiatives');
          const currentView = ref('loading'); // e.g., 'loading', 'program', 'people', etc.
          const schema = ref(null);
          const rawData = ref(null);

          // Derived data placeholders (can be computed properties later)
          const programData = ref(null);
          const peopleData = ref([]);
          const opportunitiesData = ref([]);
          const initiativesData = ref([]);

          async function loadCoreData() {
            try {
              message.value = 'Fetching schema...';
              const schemaResponse = await fetch('./public/schema.json');
              if (!schemaResponse.ok) throw new Error(`HTTP error loading schema.json! Status: ${schemaResponse.status}`);
              schema.value = await schemaResponse.json();
              message.value = 'Fetching sample data...';

              const dataResponse = await fetch('./public/sample-data.json');
              if (!dataResponse.ok) throw new Error(`HTTP error loading sample-data.json! Status: ${dataResponse.status}`);
              const loadedRawData = await dataResponse.json();
              rawData.value = loadedRawData;

              // Populate specific data refs (basic example)
              programData.value = loadedRawData.program;
              peopleData.value = loadedRawData.people;
              opportunitiesData.value = loadedRawData.opportunities;
              initiativesData.value = loadedRawData.initiatives;

              message.value = 'Core data loaded successfully.';
              currentView.value = 'program'; // Default view after successful load
            } catch (e) {
              console.error('Error loading core data:', e);
              message.value = 'Error loading core data: ' + e.message;
              currentView.value = 'error'; // Set view to an error state
            }
          }

          onMounted(() => {
            loadCoreData();
          });

          // Example of a computed property
          const programName = computed(() => {
            return programData.value ? programData.value.programName : 'Program';
          });

          return {
            message,
            appTitle,
            currentView,
            schema, // For potential display or debugging
            rawData, // For potential display or debugging
            programData,
            peopleData,
            opportunitiesData,
            initiativesData,
            programName
          };
        },
        template: `
          <div class="min-h-screen flex flex-col">
            <header class="bg-slate-800 text-white p-4 shadow-md">
              <div class="container mx-auto flex justify-between items-center">
                <h1 class="text-2xl font-bold">{{ appTitle }}</h1>
                <!-- Add user/auth placeholder if needed later -->
              </div>
            </header>
            <nav class="bg-slate-700 text-white shadow-sm">
              <div class="container mx-auto flex space-x-1">
                <button @click="currentView = 'program'" :class="{'bg-slate-900 text-white': currentView === 'program', 'text-slate-300 hover:bg-slate-600 hover:text-white': currentView !== 'program'}" class="px-3 py-2 rounded-md text-sm font-medium">Program Config</button>
                <button @click="currentView = 'people'" :class="{'bg-slate-900 text-white': currentView === 'people', 'text-slate-300 hover:bg-slate-600 hover:text-white': currentView !== 'people'}" class="px-3 py-2 rounded-md text-sm font-medium">People</button>
                <button @click="currentView = 'opportunities'" :class="{'bg-slate-900 text-white': currentView === 'opportunities', 'text-slate-300 hover:bg-slate-600 hover:text-white': currentView !== 'opportunities'}" class="px-3 py-2 rounded-md text-sm font-medium">Opportunities</button>
                <button @click="currentView = 'initiatives'" :class="{'bg-slate-900 text-white': currentView === 'initiatives', 'text-slate-300 hover:bg-slate-600 hover:text-white': currentView !== 'initiatives'}" class="px-3 py-2 rounded-md text-sm font-medium">Initiatives</button>
              </div>
            </nav>
            <main class="container mx-auto p-4 flex-grow">
              <div v-if="currentView === 'loading'" class="text-center py-10">
                <p class="text-lg text-slate-700">{{ message }}</p>
                <!-- Could add a spinner here -->
              </div>
              <div v-else-if="currentView === 'error'" class="text-center py-10">
                <p class="text-lg text-red-600 font-semibold">An Error Occurred</p>
                <p class="text-slate-700">{{ message }}</p>
              </div>
              <div v-else-if="currentView === 'program'">
                <h2 class="text-xl font-semibold text-slate-700 mb-4">Program Configuration: {{ programName }}</h2>
                <pre class="bg-slate-200 p-2 rounded text-xs overflow-auto">{{ JSON.stringify(programData, null, 2) }}</pre>
              </div>
              <div v-else-if="currentView === 'people'">
                <h2 class="text-xl font-semibold text-slate-700 mb-4">People ({{ peopleData.length }})</h2>
                <ul class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                  <li v-for="person in peopleData" :key="person.personId" class="bg-white p-3 rounded shadow">
                    <h3 class="font-semibold text-sky-700">{{person.personName}}</h3>
                    <p class="text-sm text-slate-600">{{person.personRole}}</p>
                  </li>
                </ul>
              </div>
              <div v-else-if="currentView === 'opportunities'">
                <h2 class="text-xl font-semibold text-slate-700 mb-4">Opportunities ({{ opportunitiesData.length }})</h2>
                 <ul class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <li v-for="opp in opportunitiesData" :key="opp.opportunityId" class="bg-white p-3 rounded shadow">
                    <h3 class="font-semibold text-sky-700">{{opp.opportunityName}}</h3>
                    <p class="text-sm text-slate-600">Status: {{opp.opportunityStatus}} | Priority: {{opp.opportunityPriority}}</p>
                  </li>
                </ul>
              </div>
              <div v-else-if="currentView === 'initiatives'">
                <h2 class="text-xl font-semibold text-slate-700 mb-4">Initiatives ({{ initiativesData.length }})</h2>
                <ul class="grid grid-cols-1 md:grid-cols-2 gap-4">
                  <li v-for="init in initiativesData" :key="init.initiativeId" class="bg-white p-3 rounded shadow">
                    <h3 class="font-semibold text-sky-700">{{init.initiativeName}}</h3>
                    <p class="text-sm text-slate-600">Type: {{init.initiativeType}} | Phase: {{init.initiativePhase}}</p>
                  </li>
                </ul>
              </div>
              <div v-else class="text-center py-10">
                <p class="text-red-500">Error: View '{{ currentView }}' not found or data not yet loaded.</p>
                <p>{{ message }}</p>
              </div>
            </main>
            <footer class="bg-slate-200 text-slate-600 text-center p-4 text-sm border-t border-slate-300">
              <p>&copy; ${new Date().getFullYear()} iNNitiatives (CDN Demo)</p>
            </footer>
          </div>
        `
      };

      createApp(App).mount('#app');
    </script>
</body>
</html>
